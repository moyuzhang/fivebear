import{g as a,a as e,l,d as s}from"./platform.D35QYocM.js";import{E as t}from"./element-plus.BDp-1BTq.js";import{x as u,r as o,h as r,y as d,A as c,I as n,P as i,H as m,M as v,aq as p,G as _,ag as f,z as y,L as b}from"./vue-vendor.C3rdx7ZB.js";import{_ as w}from"./index.Cjh-Y3mq.js";import"./utils.3cDF09Hu.js";const C={class:"sites-page"},V={class:"header"},G={class:"stats"},g={class:"stat-card"},h={class:"stat-number"},k={class:"stat-card"},I={class:"stat-number"},L={class:"stat-card"},N={class:"stat-number"},O=w(u({__name:"Sites",setup(u){const w=o(!1),O=o(!1),j=o({totalCount:0,statusCounts:{},sites:[],userId:"",timestamp:0}),D=o({url:"",username:"",password:"",rebateRate:1e-4,lotteryType:1,clientType:1});r((()=>{E()}));const E=async()=>{w.value=!0;try{const e=await a();e.success&&(j.value=e.data)}catch(e){t.error("加载失败")}finally{w.value=!1}},U=async()=>{try{(await e(D.value)).success&&(t.success("添加成功"),O.value=!1,E())}catch(a){t.error("添加失败")}};return(a,e)=>{const u=f("el-button"),o=f("el-table-column"),r=f("el-tag"),T=f("el-table"),q=f("el-input"),x=f("el-form-item"),z=f("el-form"),K=f("el-dialog"),R=p("loading");return y(),d("div",C,[c("div",V,[e[7]||(e[7]=c("h2",null,"站点管理",-1)),i(u,{type:"primary",onClick:e[0]||(e[0]=a=>O.value=!0)},{default:m((()=>e[6]||(e[6]=[b("添加站点")]))),_:1,__:[6]})]),c("div",G,[c("div",g,[c("div",h,v(j.value.totalCount),1),e[8]||(e[8]=c("div",{class:"stat-label"},"总站点数",-1))]),c("div",k,[c("div",I,v(j.value.statusCounts.LOGGED_IN||0),1),e[9]||(e[9]=c("div",{class:"stat-label"},"已登录",-1))]),c("div",L,[c("div",N,v(j.value.statusCounts.NOT_LOGGED_IN||0),1),e[10]||(e[10]=c("div",{class:"stat-label"},"未登录",-1))])]),n((y(),_(T,{data:j.value.sites},{default:m((()=>[i(o,{prop:"username",label:"用户名"}),i(o,{prop:"domain",label:"域名"}),i(o,{label:"状态"},{default:m((a=>{return[i(r,{type:(e=a.row.status,"LOGGED_IN"===e?"success":"NOT_LOGGED_IN"===e?"info":"danger")},{default:m((()=>[b(v(a.row.statusDescription),1)])),_:2},1032,["type"])];var e})),_:1}),i(o,{label:"操作"},{default:m((a=>[i(u,{size:"small",onClick:e=>(async a=>{try{(await l(a.uniqueKey)).success&&t.success("登录操作已提交")}catch(e){t.error("登录失败")}})(a.row)},{default:m((()=>e[11]||(e[11]=[b("登录")]))),_:2,__:[11]},1032,["onClick"]),i(u,{size:"small",type:"danger",onClick:e=>(async a=>{try{(await s(a.uniqueKey)).success&&(t.success("删除成功"),E())}catch(e){t.error("删除失败")}})(a.row)},{default:m((()=>e[12]||(e[12]=[b("删除")]))),_:2,__:[12]},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[R,w.value]]),i(K,{modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=a=>O.value=a),title:"添加站点"},{footer:m((()=>[i(u,{onClick:e[4]||(e[4]=a=>O.value=!1)},{default:m((()=>e[13]||(e[13]=[b("取消")]))),_:1,__:[13]}),i(u,{type:"primary",onClick:U},{default:m((()=>e[14]||(e[14]=[b("确定")]))),_:1,__:[14]})])),default:m((()=>[i(z,{model:D.value},{default:m((()=>[i(x,{label:"URL"},{default:m((()=>[i(q,{modelValue:D.value.url,"onUpdate:modelValue":e[1]||(e[1]=a=>D.value.url=a)},null,8,["modelValue"])])),_:1}),i(x,{label:"用户名"},{default:m((()=>[i(q,{modelValue:D.value.username,"onUpdate:modelValue":e[2]||(e[2]=a=>D.value.username=a)},null,8,["modelValue"])])),_:1}),i(x,{label:"密码"},{default:m((()=>[i(q,{modelValue:D.value.password,"onUpdate:modelValue":e[3]||(e[3]=a=>D.value.password=a),type:"password"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-1080a1c9"]]);export{O as default};
